---
layout: post
title: 使用python进行ClustalW格式和aligned FASTA格式转换
tags:
- bioinformatics
- programming
- python
- sequence alignment
- study
status: publish
type: post
published: true
meta:
  _searchme: '1'
  views: '1636'
---
ClustalW格式是多序列比对程序CLUSTAL W的默认输出格式，大概是这个样子：


![](https://dl.dropboxusercontent.com/u/308058/blogimages/2010/07/clw.jpg)

![](http://azaleasays.files.wordpress.com/2008/06/afa.jpg)
<div style="font-family:&quot;" class="source"><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/> <span style="color:rgb(0,136,0);font-style:italic;">#!/usr/bin/python</span><br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/> <span style="color:rgb(0,136,0);font-style:italic;">#Usage: python clw2afa.py input.clw</span><br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/> <span style="color:rgb(0,136,0);font-style:italic;">#Default output is STDOUT, you can redirect using '&gt;'</span><br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/> <span style="color:rgb(0,136,0);font-style:italic;">#You can also import it as a module, i.e. import clw2afa</span><br/><span class="lineno special"/> <br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/> import sys<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/> import re<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/> <br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/> <span style="color:rgb(0,0,128);font-weight:bold;">def</span> clw2afa(filename):<br/><span class="lineno special"/>     pat=re.compile(<span style="color:rgb(0,0,255);">'(S+)s+(S+)'</span>)<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     f=open(filename)<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     header=f.readline()<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     <span style="color:rgb(0,0,128);font-weight:bold;">if</span> <span style="font-weight:bold;">not</span> header.startswith(<span style="color:rgb(0,0,255);">'CLUSTAL'</span>) <span style="font-weight:bold;">and</span> <span style="font-weight:bold;">not</span> header.startswith(<span style="color:rgb(0,0,255);">'MUSCLE'</span>):<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>         sys.exit(<span style="color:rgb(0,0,255);">"clw2afa.py:Wrong input file type."</span>)<br/><span class="lineno special"/>     ln=f.readline()<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     <span style="color:rgb(0,0,128);font-weight:bold;">while</span> <span style="font-weight:bold;">not</span> ln.strip():<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>         ln=f.readline()<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     seqdict={}<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     EOF=False<br/><span class="lineno special"/>     <span style="color:rgb(0,0,128);font-weight:bold;">while</span> ln:<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>         m=pat.search(ln)   <br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>         <span style="color:rgb(0,0,128);font-weight:bold;">if</span> m <span style="font-weight:bold;">and</span> <span style="font-weight:bold;">not</span> <span style="color:rgb(0,0,255);">'*'</span> <span style="font-weight:bold;">in</span> ln: <br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>             seqdict[m.group(<span style="color:rgb(0,0,255);">1</span>)]=m.group(<span style="color:rgb(0,0,255);">2</span>)<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>             ln=f.readline()<br/><span class="lineno special"/>         <span style="color:rgb(0,0,128);font-weight:bold;">elif</span> <span style="font-weight:bold;">not</span> ln:<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>             EOF=True<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>             <span style="color:rgb(0,0,128);font-weight:bold;">break</span><br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>         <span style="color:rgb(0,0,128);font-weight:bold;">else</span>:<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>             <span style="color:rgb(0,0,128);font-weight:bold;">break</span><br/><span class="lineno special"/>     <span style="color:rgb(0,0,128);font-weight:bold;">if</span> <span style="font-weight:bold;">not</span> EOF:<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>         <span style="color:rgb(0,0,128);font-weight:bold;">while</span> True:<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>             ln=f.readline()<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>             <span style="color:rgb(0,0,128);font-weight:bold;">if</span> <span style="font-weight:bold;">not</span> ln:<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>                 <span style="color:rgb(0,0,128);font-weight:bold;">break</span><br/><span class="lineno special"/>             m=pat.search(ln)<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>             <span style="color:rgb(0,0,128);font-weight:bold;">if</span> m <span style="font-weight:bold;">and</span> <span style="font-weight:bold;">not</span> <span style="color:rgb(0,0,255);">'*'</span> <span style="font-weight:bold;">in</span> ln:<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>                 seqdict[m.group(<span style="color:rgb(0,0,255);">1</span>)]+=<span style="color:rgb(0,0,255);">'</span><span style="color:rgb(0,0,255);">n</span><span style="color:rgb(0,0,255);">'</span>+m.group(<span style="color:rgb(0,0,255);">2</span>)<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     f.close()<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     output=<span style="color:rgb(0,0,255);">''</span><br/><span class="lineno special"/>     <span style="color:rgb(0,0,128);font-weight:bold;">for</span> k,v <span style="font-weight:bold;">in</span> seqdict.items():<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>         output+=<span style="color:rgb(0,0,255);">'&gt;</span><span style="color:rgb(0,0,255);">%s</span><span style="color:rgb(0,0,255);">n</span><span style="color:rgb(0,0,255);">%s</span><span style="color:rgb(0,0,255);">n</span><span style="color:rgb(0,0,255);">'</span>%(k,v)<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     <span style="color:rgb(0,0,128);font-weight:bold;">return</span> output<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/> <br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/> <span style="color:rgb(0,0,128);font-weight:bold;">if</span> __name__ == <span style="color:rgb(0,0,255);">"__main__"</span>:<br/><span class="lineno special"/>     import sys<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     tt=clw2afa(sys.argv[<span style="color:rgb(0,0,255);">1</span>])<br/><span style="color:rgb(0,136,0);font-style:italic;" class="lineno"/>     <span style="color:rgb(0,0,128);font-weight:bold;">print</span> tt<br/></div>

写得有点混乱，希望大家如果使用的话把BUG报告一下^^
