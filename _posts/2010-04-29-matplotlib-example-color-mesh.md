---
layout: post
title: matplotlib绘图实例2：color mesh
tags:
- matplotlib
- programming
- python
status: publish
type: post
published: true
meta:
  _searchme: '1'
  views: '459'
  ratings_users: '2'
  ratings_score: '2'
  ratings_average: '1'
---
<a href="http://azaleasays.com/wp-content/uploads/2010/07/hotspots_24nt.png"><img class="aligncenter size-medium wp-image-1372" title="hotspots_24nt" src="http://azaleasays.com/wp-content/uploads/2010/07/hotspots_24nt.png?w=500" alt="" width="500" height="375" /></a>
此图的目的是两两比较不同样本的相似性，有点类似于基因芯片的 heatmap，感兴趣其生物学意义的筒子可以看<a href="http://www.plantcell.org/cgi/content/short/tpc.110.073882?keytype=ref&amp;ijkey=ChuzaZwudrANgEF" target="_blank">paper</a>。这个是草图，后来保存成ps格式导入Adobe Illustrator修改了不少地方。

以下是Python代码：
<pre>
<div class="source" style="font-family:&amp;color:#000000;">
<span style="color:#000000;">from</span> <span style="color:#000000;">matplotlib</span> <span style="color:#000080;font-weight:bold;">import</span> <span style="color:#000000;">rc</span>

<span style="color:#008800;font-style:italic;"># Change the default font</span>
<span style="color:#000000;">font</span> <span style="color:#000000;">=</span> <span style="color:#000000;">{</span><span style="color:#0000ff;">'family'</span> <span style="color:#000000;">:</span> <span style="color:#0000ff;">'sans-serif'</span><span style="color:#000000;">,</span>
<span style="color:#0000ff;">'sans-serif'</span> <span style="color:#000000;">:</span> <span style="color:#0000ff;">'Arial'</span><span style="color:#000000;">,</span>
<span style="color:#0000ff;">'size'</span> <span style="color:#000000;">:</span> <span style="color:#0000ff;">'12.0'</span><span style="color:#000000;">}</span>
<span style="color:#000000;">rc</span>(<span style="color:#0000ff;">'font'</span><span style="color:#000000;">,</span> <span style="color:#000000;">**</span><span style="color:#000000;">font</span>)

<span style="color:#000000;">import</span> <span style="color:#000000;">matplotlib</span>
<span style="color:#000000;">import</span> <span style="color:#000000;">numpy</span> <span style="color:#000080;font-weight:bold;">as</span> np
<span style="color:#000000;">import</span> <span style="color:#000000;">matplotlib.pyplot</span> <span style="color:#000080;font-weight:bold;">as</span> <span style="color:#000000;">plt</span>
<span style="color:#000000;">import</span> <span style="color:#000000;">math</span>

<span style="color:#000080;font-weight:bold;">def</span> <span style="color:#000000;">sqrt_sym</span>(<span style="color:#000000;">x</span><span style="color:#000000;">):</span>
<span style="color:#0000ff;">    ''' A function to scale the colormap for better definition at both ends.'''</span>
<span style="color:#000000;">    sqrt_sym</span> <span style="color:#000000;">=</span> <span style="color:#000000;">math</span><span style="color:#000000;">.</span><span style="color:#000000;">sqrt</span>(<span style="color:#000000;">x</span><span style="color:#000000;">*</span><span style="color:#0000ff;">2</span><span style="color:#000000;">-</span><span style="color:#0000ff;">1</span>) <span style="color:#000080;font-weight:bold;">if</span> <span style="color:#000000;">x</span> <span style="color:#000000;">&gt;</span> <span style="color:#0000ff;">0.5</span> <span style="color:#000080;font-weight:bold;">else</span> <span style="color:#000000;">-</span><span style="color:#000000;">math</span><span style="color:#000000;">.</span><span style="color:#000000;">sqrt</span>(<span style="color:#0000ff;">1</span><span style="color:#000000;">-</span><span style="color:#000000;">x</span><span style="color:#000000;">*</span><span style="color:#0000ff;">2</span>)
<span style="color:#000080;font-weight:bold;">    return</span> (<span style="color:#000000;">sqrt_sym</span><span style="color:#000000;">+</span><span style="color:#0000ff;">1</span>)<span style="color:#000000;">/</span><span style="color:#0000ff;">2</span>

<span style="color:#000080;font-weight:bold;">def</span> <span style="color:#000000;">cmap_xmap</span>(<span style="color:#000000;">function</span><span style="color:#000000;">,</span><span style="color:#000000;">cmap</span><span style="color:#000000;">):</span>
    <span style="color:#0000ff;">''' Applies function, on the indices of colormap cmap. Beware, function</span>
<span style="color:#0000ff;">     should map the [0, 1] segment to itself, or you are in for surprises.</span>
<span style="color:#0000ff;">     Third-party function. Source:</span>
<span style="color:#0000ff;">     http://www.scipy.org/Cookbook/Matplotlib/ColormapTransformations</span>
   <span style="color:#0000ff;"> '''</span>
    <span style="color:#000000;">cdict</span> <span style="color:#000000;">=</span> <span style="color:#000000;">cmap</span><span style="color:#000000;">.</span><span style="color:#000000;">_segmentdata</span>
    <span style="color:#000000;">function_to_map</span> <span style="color:#000000;">=</span> <span style="color:#000080;font-weight:bold;">lambda</span> <span style="color:#000000;">x</span> <span style="color:#000000;">:</span> (<span style="color:#000000;">function</span>(<span style="color:#000000;">x</span><span style="color:#000000;">[</span><span style="color:#0000ff;">0</span><span style="color:#000000;">]),</span> <span style="color:#000000;">x</span><span style="color:#000000;">[</span><span style="color:#0000ff;">1</span><span style="color:#000000;">],</span> <span style="color:#000000;">x</span><span style="color:#000000;">[</span><span style="color:#0000ff;">2</span><span style="color:#000000;">])</span>
    <span style="color:#000080;font-weight:bold;">for</span> <span style="color:#000000;">key</span> <span style="font-weight:bold;">in</span> (<span style="color:#0000ff;">'red'</span><span style="color:#000000;">,</span><span style="color:#0000ff;">'green'</span><span style="color:#000000;">,</span><span style="color:#0000ff;">'blue'</span><span style="color:#000000;">):</span>
        <span style="color:#000000;">cdict</span><span style="color:#000000;">[</span><span style="color:#000000;">key</span><span style="color:#000000;">]</span> <span style="color:#000000;">=</span> <span style="color:#000000;">map</span>(<span style="color:#000000;">function_to_map</span><span style="color:#000000;">,</span> <span style="color:#000000;">cdict</span><span style="color:#000000;">[</span><span style="color:#000000;">key</span><span style="color:#000000;">])</span>
        <span style="color:#000000;">cdict</span><span style="color:#000000;">[</span><span style="color:#000000;">key</span><span style="color:#000000;">]</span><span style="color:#000000;">.</span><span style="color:#000000;">sort</span>()
<span style="color:#000000;">        print</span> <span style="color:#000000;">cdict</span>
        <span style="color:#000080;font-weight:bold;">assert</span> (<span style="color:#000000;">cdict</span><span style="color:#000000;">[</span><span style="color:#000000;">key</span><span style="color:#000000;">][</span><span style="color:#0000ff;">0</span><span style="color:#000000;">]</span><span style="color:#000000;">&lt;</span><span style="color:#0000ff;">0</span> <span style="font-weight:bold;">or</span> <span style="color:#000000;">cdict</span><span style="color:#000000;">[</span><span style="color:#000000;">key</span><span style="color:#000000;">][</span><span style="color:#000000;">-</span><span style="color:#0000ff;">1</span><span style="color:#000000;">]</span><span style="color:#000000;">&gt;</span><span style="color:#0000ff;">1</span><span style="color:#000000;">),</span>
        <span style="color:#0000ff;">    'Resulting indices extend out of the [0, 1] segment.'</span>
    <span style="color:#000080;font-weight:bold;">return</span> <span style="color:#000000;">matplotlib</span><span style="color:#000000;">.</span><span style="color:#000000;">colors</span><span style="color:#000000;">.</span><span style="color:#000000;">LinearSegmentedColormap</span>(<span style="color:#0000ff;">'colormap'</span><span style="color:#000000;">,</span><span style="color:#000000;">cdict</span><span style="color:#000000;">,</span><span style="color:#0000ff;">1024</span>)

<span style="color:#000080;font-weight:bold;">def</span> <span style="color:#000000;">set_xtick</span>(<span style="color:#000000;">ax</span><span style="color:#000000;">):</span>
    <span style="color:#000000;">plt</span><span style="color:#000000;">.</span><span style="color:#000000;">xticks</span>(np<span style="color:#000000;">.</span><span style="color:#000000;">arange</span>(<span style="color:#0000ff;">0.5</span><span style="color:#000000;">,</span><span style="color:#0000ff;">12.5</span><span style="color:#000000;">,</span><span style="color:#0000ff;">1</span><span style="color:#000000;">),</span> (<span style="color:#0000ff;">'F1'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'F2'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'F3'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'F4'</span><span style="color:#000000;">,</span><span style="color:#0000ff;">
    'Sq1'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'Se1'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'Se2'</span><span style="color:#000000;">,</span><span style="color:#0000ff;">'L1'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'L2'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'Aly-L1'</span><span style="color:#000000;">,</span><span style="color:#0000ff;">'Aly-F1'</span><span style="color:#000000;">,</span><span style="color:#0000ff;">'Aly-F2'</span>) )
<span style="color:#000000;">    plt</span><span style="color:#000000;">.</span><span style="color:#000000;">setp</span><span style="color:#000000;">([</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">0</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">1</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">2</span><span style="color:#000000;">],</span><span style="color:#000000;">
       ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">3</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">10</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">11</span><span style="color:#000000;">]],</span> <span style="color:#000000;">rotation</span><span style="color:#000000;">=</span><span style="color:#0000ff;">0</span><span style="color:#000000;">,</span><span style="color:#000000;">color</span> <span style="color:#000000;">=</span> <span style="color:#0000ff;">'r'</span>)
<span style="color:#000000;">    plt</span><span style="color:#000000;">.</span><span style="color:#000000;">setp</span><span style="color:#000000;">([</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">7</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">8</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">9</span><span style="color:#000000;">]],</span> <span style="color:#000000;">rotation</span><span style="color:#000000;">=</span><span style="color:#0000ff;">0</span><span style="color:#000000;">,</span><span style="color:#000000;">color</span> <span style="color:#000000;">=</span> <span style="color:#0000ff;">'g'</span>)
<span style="color:#000000;">    plt</span><span style="color:#000000;">.</span><span style="color:#000000;">setp</span><span style="color:#000000;">([</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">5</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">6</span><span style="color:#000000;">]],</span> <span style="color:#000000;">rotation</span><span style="color:#000000;">=</span><span style="color:#0000ff;">0</span><span style="color:#000000;">,</span><span style="color:#000000;">color</span> <span style="color:#000000;">=</span> <span style="color:#0000ff;">'b'</span>)
<span style="color:#000000;">    plt</span><span style="color:#000000;">.</span><span style="color:#000000;">setp</span><span style="color:#000000;">([</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">4</span><span style="color:#000000;">]],</span> <span style="color:#000000;">rotation</span><span style="color:#000000;">=</span><span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#000000;">color</span> <span style="color:#000000;">=</span> <span style="color:#0000ff;">'k'</span>)
<span style="color:#000000;">    plt</span><span style="color:#000000;">.</span><span style="color:#000000;">setp</span><span style="color:#000000;">([</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">10</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">11</span><span style="color:#000000;">]],</span> <span style="color:#000000;">rotation</span><span style="color:#000000;">=</span><span style="color:#0000ff;">90</span><span style="color:#000000;">,</span><span style="color:#000000;">color</span> <span style="color:#000000;">=</span> <span style="color:#0000ff;">'r'</span>)

<span style="color:#000080;font-weight:bold;">def</span> <span style="color:#000000;">set_ytick</span>(<span style="color:#000000;">ax</span><span style="color:#000000;">):</span>
    <span style="color:#000000;">plt</span><span style="color:#000000;">.</span><span style="color:#000000;">yticks</span>(np<span style="color:#000000;">.</span><span style="color:#000000;">arange</span>(<span style="color:#0000ff;">0.5</span><span style="color:#000000;">,</span><span style="color:#0000ff;">12.5</span><span style="color:#000000;">,</span><span style="color:#0000ff;">1</span><span style="color:#000000;">),</span> (<span style="color:#0000ff;">'F1'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'F2'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'F3'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'F4'</span><span style="color:#000000;">,
        </span><span style="color:#0000ff;">'Sq1'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'Se1'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'Se2'</span><span style="color:#000000;">,</span><span style="color:#0000ff;">'L1'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'L2'</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">'Aly-L1'</span><span style="color:#000000;">,</span><span style="color:#0000ff;">'Aly-F1'</span><span style="color:#000000;">,</span><span style="color:#0000ff;">'Aly-F2'</span>) )
<span style="color:#000000;">    plt</span><span style="color:#000000;">.</span><span style="color:#000000;">setp</span><span style="color:#000000;">([</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">0</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">1</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">2</span><span style="color:#000000;">],</span><span style="color:#000000;">
        ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">3</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">10</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">11</span><span style="color:#000000;">]],</span> <span style="color:#000000;">rotation</span><span style="color:#000000;">=</span><span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#000000;">color</span> <span style="color:#000000;">=</span> <span style="color:#0000ff;">'r'</span>)
<span style="color:#000000;">    plt</span><span style="color:#000000;">.</span><span style="color:#000000;">setp</span><span style="color:#000000;">([</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">7</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">8</span><span style="color:#000000;">],</span> <span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">9</span><span style="color:#000000;">]],</span> <span style="color:#000000;">rotation</span><span style="color:#000000;">=</span><span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#000000;">color</span> <span style="color:#000000;">=</span> <span style="color:#0000ff;">'g'</span>)
<span style="color:#000000;">    plt</span><span style="color:#000000;">.</span><span style="color:#000000;">setp</span><span style="color:#000000;">([</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">5</span><span style="color:#000000;">],</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">6</span><span style="color:#000000;">]],</span> <span style="color:#000000;">rotation</span><span style="color:#000000;">=</span><span style="color:#0000ff;">0</span><span style="color:#000000;">,</span><span style="color:#000000;">color</span> <span style="color:#000000;">=</span> <span style="color:#0000ff;">'b'</span>)
<span style="color:#000000;">    plt</span><span style="color:#000000;">.</span><span style="color:#000000;">setp</span><span style="color:#000000;">([</span><span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklabels</span><span style="color:#000000;">()[</span><span style="color:#0000ff;">4</span><span style="color:#000000;">]],</span> <span style="color:#000000;">rotation</span><span style="color:#000000;">=</span><span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#000000;">color</span> <span style="color:#000000;">=</span> <span style="color:#0000ff;">'k'</span>)

<span style="color:#000080;font-weight:bold;">def</span> <span style="color:#000000;">set_tick_invisible</span>(<span style="color:#000000;">ax</span><span style="color:#000000;">):</span>
    <span style="color:#000000;">xtl</span> <span style="color:#000000;">=</span> <span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_xticklines</span>() <span style="color:#000000;">+</span> <span style="color:#000000;">ax</span><span style="color:#000000;">.</span><span style="color:#000000;">get_yticklines</span>()
<span style="color:#000080;font-weight:bold;">    for</span> <span style="color:#000000;">t</span> <span style="font-weight:bold;">in</span> <span style="color:#000000;">xtl</span><span style="color:#000000;">:</span>
        <span style="color:#000000;">t</span><span style="color:#000000;">.</span><span style="color:#000000;">set_visible</span>(<span style="color:#000080;font-weight:bold;">False</span>)

<span style="color:#000080;font-weight:bold;">def</span> <span style="color:#000000;">autolabel</span>(<span style="color:#000000;">arrayA</span><span style="color:#000000;">):</span>
    <span style="color:#0000ff;">''' label each colored square with the corresponding data value. </span>
   <span style="color:#0000ff;"> If value &gt; 20, the text is in black, else in white.</span>
<span style="color:#0000ff;">    '''</span>
    <span style="color:#000080;font-weight:bold;">for</span> <span style="color:#000000;">i</span> <span style="font-weight:bold;">in</span> <span style="color:#000000;">range</span>(<span style="color:#0000ff;">12</span><span style="color:#000000;">):</span>
        <span style="color:#000080;font-weight:bold;">for</span> <span style="color:#000000;">j</span> <span style="font-weight:bold;">in</span> <span style="color:#000000;">range</span>(<span style="color:#0000ff;">12</span><span style="color:#000000;">):</span>
            <span style="color:#000080;font-weight:bold;">if</span> <span style="color:#0000ff;">20</span> <span style="color:#000000;">&lt;</span> <span style="color:#000000;">arrayA</span><span style="color:#000000;">[</span><span style="color:#000000;">i</span><span style="color:#000000;">,</span><span style="color:#000000;">j</span><span style="color:#000000;">]</span> <span style="color:#000000;">&lt;</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">:</span>
                <span style="color:#000000;">plt</span><span style="color:#000000;">.</span><span style="color:#000000;">text</span>(<span style="color:#000000;">j</span><span style="color:#000000;">+</span><span style="color:#0000ff;">0.45</span><span style="color:#000000;">,</span><span style="color:#000000;">i</span><span style="color:#000000;">+</span><span style="color:#0000ff;">0.45</span><span style="color:#000000;">,</span> <span style="color:#000000;">arrayA</span><span style="color:#000000;">[</span><span style="color:#000000;">i</span><span style="color:#000000;">,</span><span style="color:#000000;">j</span><span style="color:#000000;">],</span> <span style="color:#000000;">ha</span><span style="color:#000000;">=</span><span style="color:#0000ff;">'center'</span><span style="color:#000000;">,</span> <span style="color:#000000;">va</span><span style="color:#000000;">=</span><span style="color:#0000ff;">'bottom'</span><span style="color:#000000;">,</span><span style="color:#000000;">color</span><span style="color:#000000;">=</span><span style="color:#0000ff;">'k'</span>)
<span style="color:#000080;font-weight:bold;">            else</span><span style="color:#000000;">:</span>
                <span style="color:#000000;">plt</span><span style="color:#000000;">.</span><span style="color:#000000;">text</span>(<span style="color:#000000;">j</span><span style="color:#000000;">+</span><span style="color:#0000ff;">0.45</span><span style="color:#000000;">,</span><span style="color:#000000;">i</span><span style="color:#000000;">+</span><span style="color:#0000ff;">0.45</span><span style="color:#000000;">,</span> <span style="color:#000000;">arrayA</span><span style="color:#000000;">[</span><span style="color:#000000;">i</span><span style="color:#000000;">,</span><span style="color:#000000;">j</span><span style="color:#000000;">],</span> <span style="color:#000000;">ha</span><span style="color:#000000;">=</span><span style="color:#0000ff;">'center'</span><span style="color:#000000;">,</span> <span style="color:#000000;">va</span><span style="color:#000000;">=</span><span style="color:#0000ff;">'bottom'</span><span style="color:#000000;">,</span><span style="color:#000000;">color</span><span style="color:#000000;">=</span><span style="color:#0000ff;">'w'</span>)

<span style="color:#000000;">plotData</span> <span style="color:#000000;">=</span> <span style="color:#000000;">[</span><span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">49</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">63</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">52</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">61</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">7</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">12</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">4</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">2</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">
    49</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">50</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">55</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">37</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">2</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">21</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">3</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">5</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">
    63</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">50</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">48</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">52</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">5</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">11</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">3</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">
    52</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">55</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">48</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">42</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">4</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">15</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">2</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">
    61</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">37</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">52</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">42</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">4</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">11</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">8</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">4</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span>
    <span style="color:#0000ff;">7</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">2</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">5</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">4</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">4</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">7</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">8</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">5</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">
    12</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">21</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">11</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">15</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">11</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">7</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">9</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">9</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span>
    <span style="color:#0000ff;">4</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">3</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">3</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">8</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">8</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">9</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">14</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">
    2</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">5</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">4</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">5</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">9</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">14</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span>
    <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">2</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">7</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">7</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">
    0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">7</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">90</span><span style="color:#000000;">,</span>
    <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">1</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">0</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">7</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">90</span><span style="color:#000000;">,</span> <span style="color:#0000ff;">100</span><span style="color:#000000;">]</span>
<span style="color:#000000;">plotArray</span> <span style="color:#000000;">=</span> np<span style="color:#000000;">.</span><span style="color:#000000;">array</span>(<span style="color:#000000;">plotData</span>)
<span style="color:#000000;">plotArray</span> <span style="color:#000000;">=</span> <span style="color:#000000;">plotArray</span><span style="color:#000000;">.</span><span style="color:#000000;">reshape</span>(<span style="color:#0000ff;">12</span><span style="color:#000000;">,</span><span style="color:#0000ff;">12</span>)

<span style="color:#000000;">fig</span> <span style="color:#000000;">=</span> <span style="color:#000000;">plt</span><span style="color:#000000;">.</span><span style="color:#000000;">figure</span>()
<span style="color:#000000;">ax</span> <span style="color:#000000;">=</span> <span style="color:#000000;">fig</span><span style="color:#000000;">.</span><span style="color:#000000;">add_subplot</span>(<span style="color:#0000ff;">111</span>)

<span style="color:#000000;">mymap</span> <span style="color:#000000;">=</span> <span style="color:#000000;">cmap_xmap</span>(<span style="color:#000000;">sqrt_sym</span><span style="color:#000000;">,</span><span style="color:#000000;">plt</span><span style="color:#000000;">.</span><span style="color:#000000;">cm</span><span style="color:#000000;">.</span><span style="color:#000000;">jet</span>)
<span style="color:#000000;">plt</span><span style="color:#000000;">.</span><span style="color:#000000;">pcolormesh</span>(<span style="color:#000000;">plotArray</span><span style="color:#000000;">,</span><span style="color:#000000;">cmap</span><span style="color:#000000;">=</span><span style="color:#000000;">mymap</span>)

<span style="color:#000000;">plt</span><span style="color:#000000;">.</span><span style="color:#000000;">title</span>(<span style="color:#0000ff;">'24nt hotspots (n=100)'</span><span style="color:#000000;">,</span><span style="color:#000000;">fontsize</span><span style="color:#000000;">=</span><span style="color:#0000ff;">18</span>)
<span style="color:#000000;">set_xtick</span>(<span style="color:#000000;">ax</span>)
<span style="color:#000000;">set_ytick</span>(<span style="color:#000000;">ax</span>)
<span style="color:#000000;">set_tick_invisible</span>(<span style="color:#000000;">ax</span>)
<span style="color:#000000;">autolabel</span>(<span style="color:#000000;">plotArray</span>)

<span style="color:#000000;">plt</span><span style="color:#000000;">.</span><span style="color:#000000;">colorbar</span>(<span style="color:#000000;">orientation</span><span style="color:#000000;">=</span><span style="color:#0000ff;">'vertical'</span>)

<span style="color:#000000;">plt</span><span style="color:#000000;">.</span><span style="color:#000000;">show</span>()
<span style="color:#008800;font-style:italic;">#plt.savefig('hotspots_24nt.png')</span>
<span style="color:#008800;font-style:italic;">#plt.savefig('hotspots_24nt.ps')</span></div></pre>
